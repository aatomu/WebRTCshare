<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <title id="title">CloudflareCalls</title>
</head>
<style>
  video {
    height: 420px;
    width: 720px;
    background-color: gray;
  }
</style>

<body>
  <video id="preview" muted autoplay></video><br>
  <button id="new">New</button>
  <span id="stat"></span>
  <input type="text" id="shareURL" placeholder="share URL" readonly><br>
</body>

<script src="./assets/api.js"></script>
<script src="./assets/push.js"></script>
<script src="./assets/pull.js"></script>
<script>
  const preview = document.getElementById("preview")
  preview.addEventListener("click", () => {
    preview.muted = !preview.muted
  })
  document.getElementById("new").addEventListener("click", () => {
    newPushSession()
  })

  document.addEventListener("DOMContentLoaded", async () => {
    const sourceID = new URLSearchParams((new URL(window.location.href)).searchParams).get("id")
    if (sourceID) {
      newPullSession(sourceID)
    }
  })
</script>