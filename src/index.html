<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <title id="title">web-share</title>
  <meta charset="utf-8">
  <meta name="theme-color" content="#ff8000">

  <!-- <meta property="og:image" content="https://" /> -->
  <meta property="og:title" content="web-share" />
  <meta property="og:site_name" content="create by aatomu" />
  <meta property="og:description" content="Simple screen share service" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@aatomu" />
  <meta name="twitter:creator" content="@aatomu" />
</head>

<style>
  video {
    height: 720px;
    width: 1280px;
    background-color: gray;
  }

  .controls {
    background-color: lightgray;
  }
</style>

<body>
  <video id="preview" muted autoplay></video><br>
  <div class="controls">
    <button id="new">New</button><span id="stat"></span><br>
    <input type="text" id="shareURL" placeholder="share URL" readonly><span id="mute">Video Mute: true</span><br>
  </div>
</body>

<script src="./assets/api.js"></script>
<script src="./assets/push.js"></script>
<script src="./assets/pull.js"></script>
<script>
  const preview = document.getElementById("preview")
  preview.addEventListener("click", () => {
    preview.muted = !preview.muted
    document.getElementById("mute").innerText = `Video Mute: ${!preview.muted}`
  })

  let sessions
  // Push
  document.getElementById("new").addEventListener("click",async () => {
    sessions = await newPushSession()
  })
  // Pull
  document.addEventListener("DOMContentLoaded", async () => {
    const sourceID = new URLSearchParams((new URL(window.location.href)).searchParams).get("id")
    if (sourceID) {
      sessions = await newPullSession(sourceID)
    }
  })
</script>